_gns3_server_service:
  state: started
  enabled: yes
  bin:
    path: "/usr/local/bin/"
    file: "gns3server"
  name: gns3-server
  description: "GNS3 Server"
  user: "{{ gns3_server_user }}"
  group: "{{ gns3_server_group }}"
  home: "{{ gns3_server_home }}"
  password: "{{ gns3_server_password | password_hash('sha512') }}"
  log:
    path: "/var/log/gns3/"
    file: "gns3.log"
  run:
    path: "/var/run/gns3/"
    file: "gns3.pid"
  unit:
    path: "/lib/systemd/system/"
    file: "gns3-server.service"
  config:
    path: "/etc/gns3/"
    file: "gns3_server.conf"
  options: "--daemon"

_gns3_server_paths:
  - "{{ _gns3_server_service.config.path }}"
  - "{{ _gns3_server_service.home }}"
  - "{{ _gns3_server_service.log.path }}"
  - "{{ _gns3_server_service.run.path }}"
  - "{{ gns3_server_build_path }}"
  - "{{ gns3_server_images_path }}"
  - "{{ gns3_server_projects_path }}"
  - "{{ gns3_server_appliances_path }}"
  - "{{ gns3_server_configs_path }}"

_gns3_server_rpm_packages:
  - name:
      - http://dl.fedoraproject.org/pub/epel/epel-release-latest-{{ ansible_distribution_major_version }}.noarch.rpm
    state: present

  - name:
      - "@Development tools"
      - git
      - python34
      - python34-devel
      - python34-setuptools
      - python34-tools
      - python34-pip
      - elfutils-libelf-devel
      - libpcap-devel
      - cmake
      - glibc-static
    update_cache: yes
    state: latest

_gns3_server_deb_packages:
  - name:
      - build-essential
      - ca-certificates
      - cmake
      - curl
      - git
      - gnupg2
      - libelf-dev
      - libpcap-dev
      - libvirt-clients
      - libvirt-daemon-system
      - python3
      - python3-dev
      - python3-pip
      - python3-setuptools
      - qemu-kvm
      - qemu-utils
      - software-properties-common
      - virtinst
    state: present

_gns3_server_pip_packages:
  - name: pip
    executable: pip3
    extra_args: "--upgrade --break-system-packages"
  - name: gns3-server
    executable: pip3
    extra_args: "--upgrade --break-system-packages"
